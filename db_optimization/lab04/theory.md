# Формальні та неформальні хінти для оптимізації SELECT-запитів

Хінти можна розбити на дві групи: ті, які напряму вставляються в SQL запит типу "`/*+ IndexScan(...) */`" (pg_hint_plan ) та вплив через налаштування БД, структуру самого запиту, статистику.
Формальні хінти застосовуються лише до окремого запиту, тому якщо, наприклад, вам треба скрізь використовувати не BitMap, а Seq Scan, то ви можете налаштувати БД таким чином через неформальні хінти.
І не повторювати в кожному своєму запиті відповідні формальні хінти. 
Взагалі, під час підготовки лаби стикнувся з проблемою - як її назвати. Бо назв хінтам доволі багато. Тому просто перелічу деякі найкращі варіанти:
1. Формальні та неформальні хінти
2. Прямі та непрямі хінти
3. Явні та імпліцитні хінти
4. Хардові та м’які хінти
5. Хінти рівня SQL і хінти рівня налаштувань

Обирайте що вам більше до душі

Тепер до самої суті. В цій лабораторній роботі ми розглянемо декілька прикладів використання хінтів. По-перше, самих хінтів існує дуже багато, всіх перелічувати не буду.
По-друге, в переліку розіб'ю хінти за приблизними категоріями. Приклади хінтів у [цьому фійлі](https://github.com/halushko/kpi_ist_labs/blob/7ead580da3bf08892d5b217b0a3c0d58e8bdafc6/db_optimization/lab04/postgresql_hints.md) 

## 1. Що таке хінти (hints) у PostgreSQL
PostgreSQL не має вбудованої системи хінтів, як Oracle або MySQL. Проте існують способи непрямо або явно впливати на планувальник запитів:
1. Непрямі хінти:
   1. Вимикання певних типів сканування: SET enable_seqscan = off;
   2. Зміна cost-параметрів: random_page_cost, seq_page_cost
   3. Переписування запиту для більш ефективної оптимізації
2. Прямі хінти (через розширення pg_hint_plan):
   1. Дають змогу вставляти хінти в SQL-коментарі:
   2. Потрібно підключити розширення pg_hint_plan

## 2. Типи сканування таблиць
Просто нагадаю з попередньої лаби:<br><br>
**Seq Scan** (послідовне сканування) – читає всю таблицю. Використовується, коли немає індексу або вибірка дуже велика.<br>
**Index Scan** – шукає рядки за індексом. Добре працює на високоселективних умовах (WHERE id = ...).<br>
**Bitmap Index Scan** + **Bitmap Heap Scan** – комбінований метод, ефективний при вибірці кількох відсотків рядків.<br>
**Index Only Scan** – працює повністю з індексу, без доступу до таблиці, якщо всі потрібні поля вже є в індексі.<br>

## 3. Типи JOIN і вплив хінтів
PostgreSQL має три фізичні методи виконання JOIN:<br><br>
**Nested Loop Join** – ефективний при малому обсязі даних або наявності індексу на внутрішній таблиці.<br>
**Hash Join** – ефективний при з’єднанні великих таблиць без індексів.<br>
**Merge Join** – вимагає попереднього сортування, але дуже швидкий при злитті відсортованих джерел.<br>
